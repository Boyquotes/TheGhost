[gd_scene load_steps=16 format=3 uid="uid://bfan743wneoqh"]

[ext_resource type="PackedScene" uid="uid://1cinutwv1t3l" path="res://scenes/props/floor.tscn" id="1_qn23l"]
[ext_resource type="PackedScene" uid="uid://c5v2jrbwtfkpk" path="res://scenes/player/player.tscn" id="3_5fsbt"]
[ext_resource type="PackedScene" uid="uid://nwfp3m8cudyt" path="res://scenes/npcs/furnance/core.tscn" id="3_24p4y"]
[ext_resource type="PackedScene" uid="uid://du6pve38pu7jx" path="res://scenes/props/ramp.tscn" id="5_82eor"]
[ext_resource type="PackedScene" uid="uid://bq8q4xxajkmv0" path="res://scenes/maze.tscn" id="6_k2kex"]
[ext_resource type="PackedScene" uid="uid://bqo3tjtuvfrpx" path="res://scenes/props/elevator.tscn" id="10_cgyns"]

[sub_resource type="NavigationMesh" id="NavigationMesh_cqbhm"]
vertices = PackedVector3Array(-13.4298, 0.68489, 2.2805, -23.8298, 0.68489, 2.2805, -23.8298, 0.68489, 11.1805, -3.4298, 0.68489, 17.7805, -2.8298, 0.68489, 17.7805, -2.9298, 0.68489, 2.2805, -4.5298, 0.68489, 18.3805, -3.4298, 0.68489, 17.7805, -2.9298, 0.68489, 2.2805, -5.0298, 0.68489, 19.3805, -4.5298, 0.68489, 18.3805, -2.9298, 0.68489, 2.2805, -13.4298, 0.68489, 2.2805, -23.8298, 0.68489, 11.1805, -23.8298, 0.68489, 20.1805, -23.8298, 0.68489, 20.1805, -5.0298, 0.68489, 20.1805, -5.0298, 0.68489, 19.3805, -2.8298, 0.68489, 17.7805, 2.2702, 0.68489, 17.7805, 2.3702, 0.68489, 2.2805, -2.9298, 0.68489, 2.2805, 20.8702, 0.68489, 11.1805, 20.8702, 0.68489, 2.2805, 11.5702, 0.68489, 2.2805, 2.3702, 0.68489, 2.2805, 2.2702, 0.68489, 17.7805, 2.8702, 0.68489, 17.7805, 2.3702, 0.68489, 2.2805, 2.8702, 0.68489, 17.7805, 3.9702, 0.68489, 18.3805, 4.4702, 0.68489, 19.3805, 4.4702, 0.68489, 20.1805, 20.8702, 0.68489, 20.1805, 3.9702, 0.68489, 18.3805, 4.4702, 0.68489, 19.3805, 20.8702, 0.68489, 20.1805, 20.8702, 0.68489, 11.1805, 11.5702, 0.68489, 2.2805, 2.3702, 0.68489, 2.2805, -23.8298, 0.68489, 24.8805, -5.0298, 0.68489, 24.8805, -5.0298, 0.68489, 20.1805, -23.8298, 0.68489, 20.1805, 4.4702, 0.68489, 24.8805, 20.8702, 0.68489, 24.8805, 20.8702, 0.68489, 20.1805, 4.4702, 0.68489, 20.1805, 16.6702, 34.1849, 21.0805, 16.6702, 34.1849, 22.7805, 19.0702, 34.1849, 22.7805, 19.0702, 34.1849, 21.0805, -23.8298, 0.68489, 31.2805, -23.8298, 0.68489, 37.6805, -14.5298, 0.68489, 37.6805, -5.3298, 0.68489, 37.7805, -4.5298, 0.68489, 26.5805, -5.0298, 0.68489, 25.6805, -5.3298, 0.68489, 37.7805, -5.0298, 0.68489, 25.6805, -5.0298, 0.68489, 24.8805, -23.8298, 0.68489, 24.8805, -23.8298, 0.68489, 31.2805, -14.5298, 0.68489, 37.6805, -3.7298, 0.68489, 37.5805, -4.4298, 0.68489, 38.2805, -3.9298, 0.68489, 39.1805, 2.8702, 0.68489, 27.2805, 1.2702, 0.68489, 27.2805, 1.0702, 0.68489, 27.6805, -3.7298, 0.68489, 37.5805, -3.9298, 0.68489, 39.1805, -3.9298, 0.68489, 39.5805, 0.770197, 0.68489, 46.7805, 7.4702, 0.68489, 46.7805, 2.8702, 0.68489, 27.2805, 1.0702, 0.68489, 27.6805, 0.0701981, 0.68489, 28.1805, -3.7298, 0.68489, 37.5805, -5.4298, 0.88489, 41.0805, -6.0298, 1.08489, 41.0805, -5.9298, 1.08489, 46.7805, -4.4298, 0.68489, 40.5805, -5.4298, 0.88489, 41.0805, -5.9298, 1.08489, 46.7805, -4.97526, 0.68489, 42.835, -3.9298, 0.68489, 39.5805, -4.4298, 0.68489, 40.5805, -5.9298, 1.08489, 46.7805, 0.770197, 0.68489, 46.7805, -4.97526, 0.68489, 42.835, -4.81314, 0.68489, 46.7805, -5.02767, 0.68489, 45.6736, 20.8702, 0.68489, 24.8805, 4.4702, 0.68489, 25.6805, 3.8702, 0.68489, 26.7805, 0.0701981, 0.68489, 28.1805, -0.829802, 0.68489, 28.0805, -3.7298, 0.68489, 37.5805, 7.4702, 0.68489, 46.7805, 14.1702, 0.68489, 46.7805, 20.8702, 0.68489, 35.7805, 20.8702, 0.68489, 24.8805, 3.8702, 0.68489, 26.7805, -3.7298, 0.68489, 37.5805, 20.8702, 0.68489, 24.8805, 4.4702, 0.68489, 24.8805, 4.4702, 0.68489, 25.6805, 14.1702, 0.68489, 46.7805, 20.8702, 0.68489, 46.7805, 20.8702, 0.68489, 35.7805, 3.8702, 0.68489, 26.7805, 2.8702, 0.68489, 27.2805, -3.7298, 0.68489, 37.5805, -5.3298, 0.68489, 37.7805, -4.4298, 0.68489, 38.2805, -3.7298, 0.68489, 37.5805, -3.5298, 0.68489, 27.1805, -4.5298, 0.68489, 26.5805, -1.7298, 0.68489, 27.6805, -1.9298, 0.68489, 27.2805, -3.5298, 0.68489, 27.1805, -0.829802, 0.68489, 28.0805, -1.7298, 0.68489, 27.6805, -3.5298, 0.68489, 27.1805, -3.7298, 0.68489, 37.5805, -15.5298, 4.68489, 41.0805, -24.9298, 8.08489, 41.0805, -24.9298, 8.08489, 46.7805, -15.4298, 4.58489, 46.7805, -15.4298, 4.58489, 46.7805, -5.9298, 1.08489, 46.7805, -6.0298, 1.08489, 41.0805, -15.5298, 4.68489, 41.0805, -23.8298, 0.68489, 41.1805, -23.8298, 0.68489, 46.6805, -17.6298, 0.68489, 46.6805, -17.6298, 0.68489, 41.1805)
polygons = [PackedInt32Array(2, 1, 0), PackedInt32Array(5, 4, 3), PackedInt32Array(8, 7, 6), PackedInt32Array(10, 9, 11), PackedInt32Array(11, 9, 12), PackedInt32Array(12, 9, 13), PackedInt32Array(13, 9, 14), PackedInt32Array(17, 16, 15), PackedInt32Array(18, 21, 19), PackedInt32Array(19, 21, 20), PackedInt32Array(22, 24, 23), PackedInt32Array(27, 26, 25), PackedInt32Array(28, 30, 29), PackedInt32Array(33, 32, 31), PackedInt32Array(34, 39, 35), PackedInt32Array(35, 39, 38), PackedInt32Array(35, 38, 37), PackedInt32Array(35, 37, 36), PackedInt32Array(43, 42, 40), PackedInt32Array(40, 42, 41), PackedInt32Array(47, 46, 44), PackedInt32Array(44, 46, 45), PackedInt32Array(51, 50, 48), PackedInt32Array(48, 50, 49), PackedInt32Array(54, 53, 52), PackedInt32Array(57, 56, 55), PackedInt32Array(59, 58, 60), PackedInt32Array(60, 58, 63), PackedInt32Array(60, 63, 62), PackedInt32Array(60, 62, 61), PackedInt32Array(66, 65, 64), PackedInt32Array(69, 68, 67), PackedInt32Array(71, 70, 72), PackedInt32Array(72, 70, 73), PackedInt32Array(73, 70, 74), PackedInt32Array(76, 75, 77), PackedInt32Array(77, 75, 78), PackedInt32Array(81, 80, 79), PackedInt32Array(82, 85, 83), PackedInt32Array(83, 85, 84), PackedInt32Array(91, 92, 89), PackedInt32Array(89, 87, 86), PackedInt32Array(87, 89, 90), PackedInt32Array(90, 92, 88), PackedInt32Array(88, 92, 91), PackedInt32Array(92, 90, 89), PackedInt32Array(95, 94, 93), PackedInt32Array(98, 97, 96), PackedInt32Array(100, 99, 101), PackedInt32Array(101, 99, 102), PackedInt32Array(102, 99, 103), PackedInt32Array(103, 99, 104), PackedInt32Array(107, 106, 105), PackedInt32Array(110, 109, 108), PackedInt32Array(113, 112, 111), PackedInt32Array(115, 114, 116), PackedInt32Array(116, 114, 117), PackedInt32Array(117, 114, 118), PackedInt32Array(121, 120, 119), PackedInt32Array(123, 122, 124), PackedInt32Array(124, 122, 125), PackedInt32Array(127, 126, 128), PackedInt32Array(128, 126, 129), PackedInt32Array(133, 132, 130), PackedInt32Array(130, 132, 131), PackedInt32Array(137, 136, 134), PackedInt32Array(134, 136, 135)]
cell_size = 0.1
cell_height = 0.1
agent_height = 4.0
agent_radius = 1.7

[sub_resource type="BoxShape3D" id="BoxShape3D_r5dwp"]
size = Vector3(50, 10.5, 1)

[sub_resource type="BoxMesh" id="BoxMesh_0bgr7"]
size = Vector3(50, 10.5, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_wo23x"]
albedo_color = Color(0.286275, 0.309804, 0.286275, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_lp0qq"]
diffuse_mode = 3
specular_mode = 1
albedo_color = Color(0.192157, 0.192157, 0.192157, 1)

[sub_resource type="FogMaterial" id="FogMaterial_oswsl"]
density = 1.6
albedo = Color(0, 1, 0, 1)
emission = Color(0.0392157, 0.0196078, 0.113725, 1)
edge_fade = 5.768

[sub_resource type="FogMaterial" id="FogMaterial_2sf1i"]
density = 2.0
albedo = Color(0, 1, 0, 1)
emission = Color(0.0392157, 0.0196078, 0.113725, 1)
edge_fade = 5.768

[sub_resource type="GDScript" id="GDScript_g2q0a"]
script/source = "extends Area3D

var map = {}

func _on_body_entered(body : RigidBody3D):
	if !map.has(body.name) :
		map[body.name] = 1
		
	if map[body.name] < 2 :
		body.global_position = Vector3(body.global_position.x, 15.0, body.global_position.z)
		map[body.name]+=1
		
	elif map[body.name] == 2 :
		map[body.name] = 0
		body.freeze = true
		body.sleeping = true
		body.global_position = body.INITIAL_POSITION
		body.freeze = false
		body.sleeping = false
"

[sub_resource type="BoxShape3D" id="BoxShape3D_f6hwb"]
size = Vector3(1000, 2, 1000)

[node name="Base Level" type="Node3D"]

[node name="FurnancePlane" type="NavigationRegion3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.43, 0, -1.515)
navigation_mesh = SubResource("NavigationMesh_cqbhm")

[node name="Wall" type="StaticBody3D" parent="FurnancePlane"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -26.1298, 2.93489, 24.5006)
collision_layer = 15
collision_mask = 15
metadata/_edit_group_ = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="FurnancePlane/Wall"]
shape = SubResource("BoxShape3D_r5dwp")

[node name="MeshInstance3D" type="MeshInstance3D" parent="FurnancePlane/Wall/CollisionShape3D"]
layers = 3
mesh = SubResource("BoxMesh_0bgr7")
skeleton = NodePath("../..")
surface_material_override/0 = SubResource("StandardMaterial3D_wo23x")

[node name="Wall3" type="StaticBody3D" parent="FurnancePlane"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 23.0702, 2.93489, 24.5006)
collision_layer = 15
collision_mask = 15
metadata/_edit_group_ = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="FurnancePlane/Wall3"]
shape = SubResource("BoxShape3D_r5dwp")

[node name="MeshInstance3D" type="MeshInstance3D" parent="FurnancePlane/Wall3/CollisionShape3D"]
layers = 3
mesh = SubResource("BoxMesh_0bgr7")
skeleton = NodePath("../..")
surface_material_override/0 = SubResource("StandardMaterial3D_wo23x")

[node name="Wall2" type="StaticBody3D" parent="FurnancePlane"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, -1.6298, 2.93489, 49.0006)
collision_layer = 15
collision_mask = 15
metadata/_edit_group_ = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="FurnancePlane/Wall2"]
shape = SubResource("BoxShape3D_r5dwp")

[node name="MeshInstance3D" type="MeshInstance3D" parent="FurnancePlane/Wall2/CollisionShape3D"]
layers = 3
mesh = SubResource("BoxMesh_0bgr7")
skeleton = NodePath("../..")
surface_material_override/0 = SubResource("StandardMaterial3D_wo23x")

[node name="Wall4" type="StaticBody3D" parent="FurnancePlane"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, -1.6298, 2.93489, 0.000603437)
collision_layer = 15
collision_mask = 15
metadata/_edit_group_ = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="FurnancePlane/Wall4"]
shape = SubResource("BoxShape3D_r5dwp")

[node name="MeshInstance3D" type="MeshInstance3D" parent="FurnancePlane/Wall4/CollisionShape3D"]
layers = 3
mesh = SubResource("BoxMesh_0bgr7")
skeleton = NodePath("../..")
surface_material_override/0 = SubResource("StandardMaterial3D_wo23x")

[node name="Floor" parent="FurnancePlane" instance=ExtResource("1_qn23l")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.44828, 0, 24.4805)

[node name="Furnance" parent="FurnancePlane" instance=ExtResource("3_24p4y")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.321, 4.41, 22.551)

[node name="Ramp" parent="FurnancePlane" instance=ExtResource("5_82eor")]
transform = Transform3D(4.52918, 0, 0, 0, 4.52918, 0, 0, 0, 4.52918, -5.7, 3.665, 43.9331)

[node name="Elevator2" parent="FurnancePlane" instance=ExtResource("10_cgyns")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 17.8, 33.8, 22.8)
current_dir = "down"

[node name="CSGBox3D2" type="CSGBox3D" parent="FurnancePlane"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -27.1, 13.3, 48.8)
material_override = SubResource("StandardMaterial3D_wo23x")
use_collision = true
collision_layer = 4
collision_mask = 4
size = Vector3(1, 0.5, 1)
material = SubResource("StandardMaterial3D_lp0qq")

[node name="CSGBox3D4" type="CSGBox3D" parent="FurnancePlane"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -26.1, 10.1, 48.8)
material_override = SubResource("StandardMaterial3D_wo23x")
use_collision = true
collision_layer = 4
collision_mask = 4
size = Vector3(1, 10, 1)
material = SubResource("StandardMaterial3D_lp0qq")

[node name="FogVolume" type="FogVolume" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 112.018, 31.5217)
size = Vector3(200, 40, 200)
material = SubResource("FogMaterial_oswsl")

[node name="FogVolume2" type="FogVolume" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -74.7252, 31.5217)
size = Vector3(200, 60, 200)
material = SubResource("FogMaterial_2sf1i")

[node name="Player" parent="." instance=ExtResource("3_5fsbt")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -20.5148, 7.763, 44.9293)

[node name="DeathArea" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -75.7632, 0)
collision_layer = 15
collision_mask = 15
script = SubResource("GDScript_g2q0a")

[node name="CollisionShape3D" type="CollisionShape3D" parent="DeathArea"]
shape = SubResource("BoxShape3D_f6hwb")

[node name="Elevator" parent="." instance=ExtResource("10_cgyns")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -30.2, 4.5, 45)
current_dir = "down"

[node name="Elevator2" parent="." instance=ExtResource("10_cgyns")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -30.2, 4.5, 45)
current_dir = "down"

[node name="Maze" parent="." instance=ExtResource("6_k2kex")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.2, -32.8, -2)

[connection signal="body_entered" from="DeathArea" to="DeathArea" method="_on_body_entered"]
