[gd_scene load_steps=8 format=3 uid="uid://cwp1ve1aktg5"]

[ext_resource type="ArrayMesh" uid="uid://b6wvq2lw2aw2x" path="res://imports/grass_straw.obj" id="1_ruwlg"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_obb33"]

[sub_resource type="PlaneMesh" id="PlaneMesh_dmfss"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_2h2xt"]

[sub_resource type="GDScript" id="GDScript_4mpti"]
script/source = "extends Area3D

@onready var folliage : MultiMeshInstance3D = $Folliage
@onready var shader : Shader = preload(\"res://scenes/props/floor.gdshader\")
var shader_material : ShaderMaterial

var target : Vector3 = Vector3(global_position.x, 5.0, global_position.z)

func _ready():
	folliage.material_override = ShaderMaterial.new()
	folliage.material_override.shader = shader
	shader_material = folliage.material_override
	#shader_material.set_shader_parameter(\"radius\",1)

func _physics_process(delta):
	if shader_material == null:
		return
	if !get_overlapping_bodies().is_empty():
		#var player_area = get_overlapping_areas()\\
		#.filter(func(obj): return obj.is_in_group(\"Player\"))
		var bodies = get_overlapping_bodies()
		#if player_area.is_empty() :
		#	return
		#var player_location = player_area[0].location
		#if player_location == null:
		#	return
		print(bodies[0])
		#shader_material.set_shader_parameter(\"radius\", lerpf(shader_material.get_shader_parameter(\"radius\"), 5.0, delta))
		target.x = lerpf(target.x, bodies[0].global_position.x, delta * 8)
		target.y = lerpf(target.y, bodies[0].global_position.y, delta * 8)
		target.z = lerpf(target.z, bodies[0].global_position.z, delta * 8)
	else:
		target.y = lerpf(target.y, 7.0, delta * 2)
		#shader_material.set_shader_parameter(\"radius\", lerpf(shader_material.get_shader_parameter(\"radius\"), 1.0, delta * 0.1))
	shader_material.set_shader_parameter(\"player_pos\", target)
	
"

[sub_resource type="BoxShape3D" id="BoxShape3D_sjdxh"]
size = Vector3(3, 1, 3)

[sub_resource type="MultiMesh" id="MultiMesh_gcgb4"]
transform_format = 1
instance_count = 50
mesh = ExtResource("1_ruwlg")
buffer = PackedFloat32Array(-3.47055, 0.75236, -3.40219, -0.0411749, 0.805909, 4.845, 0.249319, 0, 3.3899, -0.381582, -3.5424, -0.85952, 3.80561, -0.250151, 2.53077, 0.622458, -0.281074, 4.48565, 0.86604, 0, -2.52752, -0.875473, 3.71419, 0.969163, 2.01387, 1.12092, -4.14958, 0.30374, -1.80984, 4.37757, 0.304155, 0, 3.89871, 1.45313, 2.28465, 0.737234, 3.95158, 1.43879, 3.1916, 0.224806, -1.93302, 4.90943, 0.180108, 0, -2.91889, -1.30341, 4.20151, 0.0987123, 4.09137, -0.319137, 3.33457, -0.626194, -0.522611, 5.13845, 1.133, 0, -3.30879, -1.20622, 3.94429, 0.0260947, -4.5259, -0.798156, -0.086073, -0.804814, -0.802763, 4.49613, 0.518306, 0, -0.00580733, 0.525372, -4.56642, -0.149905, -5.0708, -0.58556, 1.67487, -0.183538, -0.492292, 5.33647, 0.375258, 0, -1.70462, 0.200723, -5.09069, -0.825851, -4.33416, -1.12232, -2.13676, -0.944861, -0.701373, 4.78805, -1.09223, 0, 2.30942, -0.652151, -4.34184, 0.0500675, -2.63578, -1.14381, 3.74518, 0.0440328, 0.0355893, 4.50735, 1.40163, 0, -3.91579, 0.810886, -2.5082, 0.965857, -4.86247, 1.30061, -1.76956, 0.0963326, 1.39664, 5.14908, -0.0532097, 0, 1.69479, -0.511707, -5.03312, 0.595706, -0.564592, 0.386937, -4.86746, 0.904674, -0.639783, 4.85179, 0.459902, 0, 4.84072, 0.686375, -0.506927, -0.0138354, -0.422016, -0.874925, 5.19236, -0.705065, 1.46381, 4.98419, 0.95882, 0, -5.058, 1.51545, -0.155739, 0.606958, 0.936381, -0.852193, -5.33453, 0.0900305, -0.676314, 5.35299, -0.973856, 0, 5.35967, 0.824356, 0.809102, 0.577578, -0.150782, -0.4979, 4.55592, -0.109779, 0.759004, 4.49272, 0.516113, 0, -4.51976, 0.771075, -0.0653171, 0.809088, 1.92001, 1.4902, -4.87821, -0.382283, 0.641055, 5.10054, 1.81042, 0, 5.0603, -1.21157, 1.62157, 0.937601, 2.90415, 0.486229, 4.45754, -0.682705, 1.11752, 5.06473, -1.28054, 0, -4.34249, 1.62857, 2.65155, 0.619998, 4.14034, 1.37783, 2.57942, 0.240444, -1.12953, 4.87756, -0.79236, 0, -2.69741, 0.0724237, 4.29104, 0.589133, -0.561723, 1.03494, -4.77622, 0.00696599, 0.414659, 4.80042, 0.991413, 0, 4.86944, -0.289395, -0.635394, -0.731807, 5.41871, -0.580042, 0.537637, -0.440988, 0.428012, 5.28109, 1.38379, 0, -0.665063, -1.32726, 5.27105, -0.412842, 1.51705, -0.273599, 4.57818, -0.445516, 0.669245, 4.78372, 0.0641186, 0, -4.53725, 0.61412, 1.54019, -0.312736, -4.63885, 0.728657, 0.772279, 0.915509, 0.847149, 4.6266, 0.723302, 0, -0.640074, 0.842548, -4.63969, -0.937537, 3.05156, -0.848428, -3.90707, -0.705479, 1.63949, 4.74836, 0.249384, 0, 3.64652, -1.42488, 3.15747, -0.796543, -4.80723, 1.14646, 1.24562, 0.747145, 1.33838, 4.87011, 0.6828, 0, -1.03667, 0.971134, -4.89466, 0.879952, 4.4226, 0.133351, 1.60652, -0.560668, -0.13873, 4.70518, -0.00864666, 0, -1.60606, -0.0392229, 4.4246, -0.295141, -1.392, -0.0733503, 4.39735, 0.137251, -1.23126, 4.43441, -0.315793, 0, -4.22209, -1.269, -1.35769, -0.0893838, 3.24608, 0.80764, 3.33105, 0.615455, -1.16133, 4.57559, 0.0223212, 0, -3.22482, -0.834811, 3.34497, 0.434885, 0.327401, -0.559097, -5.16623, -0.850611, 0.65951, 5.13908, -0.514364, 0, 5.15437, -0.62204, 0.393968, 0.482547, -5.25792, 0.965462, -1.25213, 0.455397, 1.05313, 5.38166, -0.272712, 0, 1.17936, -0.50133, -5.33886, 0.216242, 4.74786, 0.687026, 2.0238, 0.664414, -0.991766, 5.07562, 0.60366, 0, -1.89319, -0.935949, 4.75918, -0.52913, -2.07582, -0.905929, -4.75786, 0.746849, 0.0772562, 5.16958, -1.01803, 0, 4.84272, -0.470795, -2.02321, 0.85158, -5.05964, 0.868113, -1.2067, -0.00414801, 0.869515, 5.20044, 0.0954138, 0, 1.20569, -0.107421, -5.13269, 0.545009, 1.34189, 0.952181, 4.64319, -0.198976, -1.60627, 4.63149, -0.485569, 0, -4.45935, -1.38175, 1.57211, 0.2083, 2.05051, 0.479407, -3.98702, 0.306566, -1.33409, 4.30377, -0.168625, 0, 3.78765, 1.25635, 2.09904, -0.489978, -5.0082, -0.891618, -0.704608, -0.446476, -0.958486, 5.02478, 0.454297, 0, 0.610541, 0.574542, -5.06662, 0.908802, 4.32591, -1.01106, 1.13301, -0.659427, 0.601881, 4.28217, 1.52323, 0, -1.39416, -1.28851, 4.17319, -0.078043, -1.49614, 0.69341, -4.58271, -0.431267, 0.632135, 4.80108, 0.520076, 0, 4.59156, -0.435036, -1.56485, 0.860509, -4.62371, -0.429118, -1.87567, 0.740116, -0.546364, 4.97382, 0.208926, 0, 1.84493, 0.397519, -4.63888, 0.221841, -4.08816, 0.650344, 1.8068, 0.673191, 0.216369, 4.37872, -1.08652, 0, -1.90805, -0.896879, -3.99444, 0.946993, 4.28082, -1.55607, -2.9062, -0.810256, 1.63093, 5.13915, -0.34931, 0, 2.86486, -0.600489, 4.54145, 0.85369, -4.34148, 1.00025, 1.37344, 0.0174748, 0.475515, 4.33332, -1.65274, 0, -1.63117, -1.39899, -4.13732, 0.80098, -3.78984, 1.03108, -3.02642, -0.694673, 0.519306, 4.82963, 0.995116, 0, 3.15478, 0.443634, -3.79944, -0.0369611, 4.46484, 1.33986, 0.311091, 0.20023, -1.3752, 4.32629, 1.104, 0, 0.0285393, -1.14664, 4.52893, 0.840084, 0.189527, 1.19311, -4.58412, -0.0676346, -1.14365, 4.46359, 1.11446, 0, 4.5967, 1.06134, 0.466282, -0.284503, 0.561966, 1.11399, 5.34135, 0.621628, 0.951798, 5.26727, -1.19868, 0, -5.37263, 1.04965, 0.346341, 0.719748, 2.153, 0.700968, -4.52777, 0.0619326, 0.132904, 4.9911, 0.835896, 0, 4.57978, -0.474372, 2.10429, -0.115728, -4.89521, 0.852163, 1.62573, 0.686923, 1.17155, 5.01516, 0.898836, 0, -1.41303, 1.20593, -4.88686, 0.573492, -3.46333, 1.54712, -3.71499, 0.616341, 0.917991, 5.07582, 1.25804, 0, 3.91816, 0.178303, -3.57849, 0.347386, 3.55304, -1.40511, 3.69143, 0.361678, 0.198846, 5.02253, 1.7204, 0, -3.9448, -1.0124, 3.41155, -0.200343, -3.36488, 1.04352, -2.88417, -0.206163, 0.41752, 4.39737, 1.1039, 0, 3.03859, 0.551347, -3.34556, 0.534539, 1.60362, 0.284144, 5.13319, -0.23772, -0.0500257, 5.37772, -0.282052, 0, -5.1408, 0.0363044, 1.60399, 0.939023)

[node name="Grass" type="Node3D"]

[node name="Plane" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, -3.55271e-15, 0, 1, 0, 3.55271e-15, 0, 1, 0, 0, 0)
visible = false
material_override = SubResource("StandardMaterial3D_obb33")
mesh = SubResource("PlaneMesh_dmfss")
skeleton = NodePath("")
surface_material_override/0 = SubResource("StandardMaterial3D_2h2xt")

[node name="GrassStraw" type="MeshInstance3D" parent="."]
visible = false
mesh = ExtResource("1_ruwlg")

[node name="Area3D" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 11
priority = 128.0
script = SubResource("GDScript_4mpti")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.42499, 0)
shape = SubResource("BoxShape3D_sjdxh")

[node name="Folliage" type="MultiMeshInstance3D" parent="Area3D"]
multimesh = SubResource("MultiMesh_gcgb4")
